language: java
jdk:
  - openjdk11
branches:
  only:
    - master
    - develop
cache:
  directories:
    - "$HOME/.m2"
    - "$HOME/.gradle/caches/"
    - "$HOME/.gradle/wrapper/"
env:
  global:
    - TERM=dumb
    - secure: g7bJ2EJPsMJ0ErYq2IVd1mPRL39schphsrPZtkicaolth5U3JfxUlc9jtNF2zbuBjY3dSrF/hqXdLkVn8AEIdGDf0FcX9ErP9jRotj9Ll0nF1yoAk5IDlhvLeETbiM+XPR8P1prSaKHz0lL4YGKR2kExjRLEQFJilLvoJoVuDP2K49KTpyGEPitw80RyH00lU50Rc8DNcqGQAVO1JHLjvLn782LPTBs4WNct9sIjKrGS+4qFdNNivq49sr4YP2hn9AhbPRBKDBFBmBZrgsRri7s5ZC28/En+LYZoYEfvNjQi9s3TpBl/NSLXau14ZQCBr3Q6GihfCjzmInD0VE7tM0galhHl+NVM5uRiEwy5QONyeNFhibBMPAmDif8KW/HvP9UGTxhq0pGn5C5IyBj6PVdvKlQA13HCB+HsJ1sCxoPj/Ge6wyt7EMREq87YQXmNtD79Tf4zbX9E9njGpUFSau+jyCL1LouxqV/AGtcWlrBfKaZm8Q9dq+agTv5qlEKHZ4RuwOluv3h3lGJQybBtl0cUaZLItkSNqDoHM/3ewrQOXkdAITC3JVylqAb9A51ZMRsC89UPRtF3k/e7rqZQogeiHOLXstQVUgTyU1sKH1bwZCHKQWLpbKO4NCo9yFtNR20V5VGXL3uYEOEFccsMMU8K+Q0Zd+BqUrir96XsTuo=
    - secure: FN33pzlyDmxuTw2PW3i4LNJ5Q+H+X1JK6DHctTuXLUSXvP68rdDZgE9umgjbBY3aCMq9Wb2Z2e6DxgnHnyZczvLtwvOM1DE7xC6Gnb0hQtYAg/m5wd+Li/t0XOrJFdFwUNYwe24jw+szG7l6sEJdByTaZs0xy5ZeBLJGTLmOmjk5Ddz7bBMeex23vhliDS45H3qiAUq9KdVSBl8lt1KrVWRfWRYsIgZVpa/K96skhPPAoh/nzmov6XI+ZTwrvgOXcG8xXnmxM7sR9xyI2TEcHMAox/HpDSYXGFcL1b6ImX/AjcfkGRjcHQBcEcfw/hG/YOyK6YbQyIJx/5IeeeaxLK9boOc6GDsKzVS0n740ozEJTuFhJO8tYARiPGJrmjGG+1bhydFBmzRXXiu0CM9kTu19gQ+1OkRrpjyQbK+0jGM9o1l+zzvoqYtmEbGaEJ7mMJiMRguPbcLsllLlZgWezdsdUOtaGWsol/z54rFZGu/AC7CspXsvRSQpzWmjfkDLbDQSnYIQ4qVuIYjK1d8yppj7RE//4OO7TiLm7zAw7sc9rjiCyEZ7LOnwiDPJtgho+BlIz0dZauPUAVfhcKS4dWkfsUhmDBlbbiE0mTVHLQcoCubfYAnEJBbuyXohnvkJUbLqMBegoLOvvx9zmFiJ6tmDkGKE4TpZqhoJbXClyNY=
install: true
script:
  - "./gradlew check"
  - "./gradlew jib -Djib.to.auth.username=$DOCKER_USER -Djib.to.auth.password=$DOCKER_PASS"
before_cache:
  - rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
  - rm -fr $HOME/.gradle/caches/*/plugin-resolution/
  - rm -fr $HOME/.gradle/caches/*/fileHashes/
  - rm -fr $HOME/.gradle/caches/jars-3/
